flowchart TD
    Env[CHANGED_FILES]
    Runner[PlanRunner]
    Strategy[RoleFileParsingStrategy]
    Loaded[LoadedFile (ROLES)]
    State[StateRepository.findPayload]
    Compare[PlanService.payloadsEqual]
    New[PlanItem NEW]
    Update[PlanItem UPDATE]
    Delete[PlanItem DELETE]

    Env --> Runner --> Strategy --> Loaded --> Compare
    Loaded --> State --> Compare
    Compare -->|no state| New
    Compare -->|differs| Update
    Runner -->|path missing| Delete
